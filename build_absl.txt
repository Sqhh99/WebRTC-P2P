cmake .. -G "Visual Studio 17 2022" -A x64 `
  -DCMAKE_BUILD_TYPE=Release `
  -DCMAKE_CXX_STANDARD=20 `
  -DCMAKE_MSVC_RUNTIME_LIBRARY=MultiThreaded `
  -DABSL_PROPAGATE_CXX_STD=ON `
  -DABSL_USE_EXTERNAL_GOOGLETEST=OFF `
  -DABSL_BUILD_TESTING=OFF `
  -DCMAKE_INSTALL_PREFIX=install

cmake --build . --config Release
cmake --install . --config Release

# 在project添加以下内容
if(MSVC OR MSVC_IDE)
    # 强制所有目标使用静态运行时
    set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>")
    
    # 移除所有 /MD 相关的标志
    foreach(flag_var
        CMAKE_CXX_FLAGS CMAKE_CXX_FLAGS_DEBUG CMAKE_CXX_FLAGS_RELEASE
        CMAKE_CXX_FLAGS_MINSIZEREL CMAKE_CXX_FLAGS_RELWITHDEBINFO
        CMAKE_C_FLAGS CMAKE_C_FLAGS_DEBUG CMAKE_C_FLAGS_RELEASE
        CMAKE_C_FLAGS_MINSIZEREL CMAKE_C_FLAGS_RELWITHDEBINFO)
        if(${flag_var} MATCHES "/MD")
            string(REGEX REPLACE "/MD" "/MT" ${flag_var} "${${flag_var}}")
        endif()
    endforeach()
    
    # 设置编译选项
    add_compile_options(
        $<$<CONFIG:Release>:/MT>
        $<$<CONFIG:Debug>:/MTd>
    )
endif()
